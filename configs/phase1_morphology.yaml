seed: 0

data:
  csv_path: data/metadata/blastocyst.csv
  data_root: data
  task: morphology
  use_predefined_split: true

  train_frac: 0.64
  val_frac: 0.16
  test_frac: 0.2

  batch_size: 32
  num_workers: 4

  resize_size: 256
  crop_size: 224

  rotation_deg: 5
  color_jitter: 0.0
  horizontal_flip: 0.5

  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std:  [0.229, 0.224, 0.225]

model:
  name: ivf_morph_stage_head
  backbone: ivf_convnext_lite
  dropout: 0.2
  enable_quality: false
  enable_stage: true
  enable_morph: true
  num_stage_classes: 3
  num_exp_classes: 6
  num_icm_classes: 3
  num_te_classes: 3
  stem_stride: 2
  dims: [64, 128, 256, 512]
  depths: [2, 2, 6, 2]
  drop_path_rate: 0.15
  mlp_ratio: 4
  layer_scale_init: 1.0e-6

training:
  task: morphology
  epochs: 40
  lr: 0.0003
  weight_decay: 0.0005

  loss_weights:
    exp: 1.0
    icm: 1.0
    te: 1.0

  early_stopping:
    monitor: val_loss
    patience: 10

  precision: 32
  accelerator: auto
  devices: 1
  deterministic: true

logging:
  output_dir: outputs_phase1_morphology
